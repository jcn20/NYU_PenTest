$portrange = (8075..8085)
$iprange =( 33..38) #Testing for usable IPs in 10.10.0.32/29
$netadd = "10.10.0"

$ErrorActionPreference='silentlycontinue'

foreach ($ipadd in $iprange)
{
	$count = 0
	$openports = @()
	$ip = "{0}.{1}" -F $netadd,$ipadd
        foreach ($port in $portrange)
	{
		If(Test-Connection -BufferSize 32 -Count 1 -quiet -ComputerName $ip)
		{
			$socket = new-object System.Net.Sockets.TcpClient($ip, $port)
			If($socket.Connected) {
				"$ip port $port open"
				++$count
				$openports += $port
				$socket.Close() }
			else {
				"$ip port $port not open "
			}
			
		} 

 	}
	If ($openports.Count -eq 0){
		"$ip doesn't have any ports open."
	}
	else{
		"$ip has $count port(s) open and they are: $openports"
	}
}
 	

